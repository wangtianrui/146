# Flow

![image-20210608213535884](./pics\image-20210608213535884.png)

一般来讲。我们训练模型都是输入Z输出X。那么按照极大似然来看，就是要最大化$P_G(x^i)$，其中$x^i$是目标数据集的取样。那么怎么去度量这个$P_G(x^i)$和目标“像”，一般来讲是通过KL散度进行度量。

但是Flow没有采用这种思想。而是倒过来。



### 数学基础

#### Jacobian

![image-20210608214409228](./pics\image-20210608214409228.png)

#### Determinant

![image-20210608214522760](./pics\image-20210608214522760.png)

determinant的含义：高维空间的体积

![image-20210608214618378](./pics\image-20210608214618378.png)

#### Change of Variable Theorem

寻找两个分布之间的关系（分布是由一个f转换的）

![image-20210608214921516](./pics\image-20210608214921516.png)



![image-20210608215157907](./pics\image-20210608215157907.png)

高度不变。所以要加绝对值

二维例子

目的：求pi(z)到p(x)的转换函数

![image-20210608215506645](./pics\image-20210608215506645.png)

$x_{11}$是$z_1$改变的时候，$x_1$的改变量。其他以此类推

![image-20210608215740628](./pics\image-20210608215740628.png)



## Flow-base

![image-20210608220020084](./pics\image-20210608220020084.png)

det(J_G)，限制了J_G一定是好算的。维度也不能太高。然后$G^{-1}$，也需要限制输入和输出一样大。

G被限制了，怎么办？那就flow来了。一长串G

![image-20210608220159598](./pics\image-20210608220159598.png)

![image-20210608220246038](./pics\image-20210608220246038.png)

